"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[1749],{26998:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>c});var i=s(74848),r=s(28453);const o={sidebar_position:2},t="\u6a21\u578b\u67b6\u69cb\u8a2d\u8a08",a={id:"docaligner/training/model_arch",title:"\u6a21\u578b\u67b6\u69cb\u8a2d\u8a08",description:"\u71b1\u5716\u56de\u6b78",source:"@site/docs/docaligner/training/model_arch.md",sourceDirName:"docaligner/training",slug:"/docaligner/training/model_arch",permalink:"/docaligner/training/model_arch",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"zephyr-sh",lastUpdatedAt:1712763369e3,sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"\u8cc7\u6599\u96c6\u524d\u8655\u7406",permalink:"/docaligner/training/preprocess"},next:{title:"\u8a13\u7df4\u6a21\u578b",permalink:"/docaligner/training/train_model"}},l={},c=[{value:"\u71b1\u5716\u56de\u6b78",id:"\u71b1\u5716\u56de\u6b78",level:2},{value:"Backbone",id:"backbone",level:3},{value:"Neck: BiFPN",id:"neck-bifpn",level:3},{value:"Head: Heatmap Regression",id:"head-heatmap-regression",level:3},{value:"Loss: Adaptive Wing Loss",id:"loss-adaptive-wing-loss",level:3},{value:"\u9ede\u56de\u6b78",id:"\u9ede\u56de\u6b78",level:2},{value:"Backbone",id:"backbone-1",level:3},{value:"Neck: Cross-Attention",id:"neck-cross-attention",level:3},{value:"Head: Point Regression",id:"head-point-regression",level:3},{value:"Loss: Smooth L1 Loss",id:"loss-smooth-l1-loss",level:3}];function d(e){const n={a:"a",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"\u6a21\u578b\u67b6\u69cb\u8a2d\u8a08",children:"\u6a21\u578b\u67b6\u69cb\u8a2d\u8a08"}),"\n",(0,i.jsx)(n.h2,{id:"\u71b1\u5716\u56de\u6b78",children:"\u71b1\u5716\u56de\u6b78"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"heatmap-arch",src:s(31863).A+"",width:"3277",height:"1929"})}),"\n",(0,i.jsx)(n.h3,{id:"backbone",children:"Backbone"}),"\n",(0,i.jsx)(n.p,{children:"Backbone \u662f\u6a21\u578b\u7684\u4e3b\u9ad4\uff0c\u8ca0\u8cac\u63d0\u53d6\u8f38\u5165\u6578\u64da\u4e2d\u7684\u7279\u5fb5\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u9019\u500b\u6a21\u578b\u4e2d\uff0c\u4f7f\u7528\u7684\u662f FastViT\u3001MobileNetV2 \u6216 LCNet\uff0c\u9019\u4e9b\u90fd\u662f\u8f15\u91cf\u7d1a\u7684\u5377\u7a4d\u795e\u7d93\u7db2\u7d61\uff0c\u7279\u5225\u9069\u7528\u65bc\u5728\u8a08\u7b97\u8cc7\u6e90\u53d7\u9650\u7684\u74b0\u5883\u4e0b\u9032\u884c\u9ad8\u6548\u7684\u7279\u5fb5\u63d0\u53d6\u3002\u6211\u5011\u9810\u671f Backbone \u61c9\u8a72\u80fd\u5f9e\u8f38\u5165\u6578\u64da\u4e2d\u63d0\u53d6\u51fa\u8db3\u5920\u7684\u7279\u5fb5\u4fe1\u606f\uff0c\u70ba\u5f8c\u7e8c\u7684\u71b1\u5716\u56de\u6b78\u505a\u597d\u6e96\u5099\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["Reference: ",(0,i.jsx)(n.a,{href:"https://arxiv.org/abs/2303.14189",children:"FastViT: A Fast Hybrid Vision Transformer using Structural Reparameterization"})]})}),"\n",(0,i.jsx)(n.h3,{id:"neck-bifpn",children:"Neck: BiFPN"}),"\n",(0,i.jsx)(n.p,{children:"Neck \u90e8\u5206\u662f\u7528\u65bc\u589e\u5f37\u5f9e Backbone \u6d41\u51fa\u7684\u7279\u5fb5\u3002"}),"\n",(0,i.jsx)(n.p,{children:"BiFPN (Bidirectional Feature Pyramid Network) \u901a\u904e\u4e0a\u4e0b\u6587\u4fe1\u606f\u7684\u96d9\u5411\u6d41\u52d5\uff0c\u589e\u5f37\u4e86\u7279\u5fb5\u7684\u8868\u9054\u80fd\u529b\u3002\u6211\u5011\u9810\u671f BiFPN \u6703\u7522\u751f\u4e00\u7cfb\u5217\u5c3a\u5ea6\u8c50\u5bcc\u4e14\u8a9e\u7fa9\u5f37\u7684\u7279\u5fb5\u5716\uff0c\u9019\u4e9b\u7279\u5fb5\u5716\u5c0d\u65bc\u6355\u6349\u4e0d\u540c\u5c3a\u5ea6\u7684\u5c0d\u8c61\u975e\u5e38\u6709\u6548\uff0c\u4e26\u5c0d\u6700\u7d42\u7684\u9810\u6e2c\u7cbe\u5ea6\u6709\u6b63\u9762\u5f71\u97ff\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"head-heatmap-regression",children:"Head: Heatmap Regression"}),"\n",(0,i.jsx)(n.p,{children:"Head \u90e8\u5206\u662f\u6a21\u578b\u7684\u6700\u7d42\u968e\u6bb5\uff0c\u5c08\u9580\u7528\u65bc\u6839\u64da\u524d\u9762\u63d0\u53d6\u548c\u52a0\u5f37\u7684\u7279\u5fb5\u4f86\u9032\u884c\u6700\u7d42\u7684\u9810\u6e2c\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u9019\u500b\u6a21\u578b\u4e2d\uff0c\u4f7f\u7528\u7684\u662f\u71b1\u5716\u56de\u6b78\u6280\u8853\uff0c\u9019\u662f\u4e00\u7a2e\u5e38\u7528\u65bc\u7269\u9ad4\u6aa2\u6e2c\u548c\u59ff\u52e2\u4f30\u8a08\u7684\u65b9\u6cd5\uff0c\u80fd\u5920\u7cbe\u78ba\u5730\u9810\u6e2c\u5c0d\u8c61\u7684\u4f4d\u7f6e\u3002\u71b1\u5716\u56de\u6b78\u5c07\u751f\u6210\u7269\u9ad4\u7684\u71b1\u5716\u8868\u793a\uff0c\u9019\u4e9b\u71b1\u5716\u53cd\u6620\u4e86\u7269\u9ad4\u51fa\u73fe\u5728\u4e0d\u540c\u4f4d\u7f6e\u7684\u53ef\u80fd\u6027\u3002\u901a\u904e\u5206\u6790\u9019\u4e9b\u71b1\u5716\uff0c\u6a21\u578b\u80fd\u5920\u6e96\u78ba\u5730\u9810\u6e2c\u51fa\u7269\u9ad4\u7684\u4f4d\u7f6e\u548c\u59ff\u614b\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"loss-adaptive-wing-loss",children:"Loss: Adaptive Wing Loss"}),"\n",(0,i.jsx)(n.p,{children:"Loss \u662f\u6a21\u578b\u8a13\u7df4\u7684\u95dc\u9375\uff0c\u8ca0\u8cac\u8a08\u7b97\u6a21\u578b\u9810\u6e2c\u7d50\u679c\u548c\u771f\u5be6\u6a19\u7c64\u4e4b\u9593\u7684\u5dee\u7570\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u9019\u500b\u6a21\u578b\u4e2d\uff0c\u4f7f\u7528\u7684\u662f Adaptive Wing Loss\uff0c\u9019\u662f\u4e00\u7a2e\u5c08\u9580\u7528\u65bc\u4eba\u81c9\u95dc\u9375\u9ede\u6aa2\u6e2c\u7684\u640d\u5931\u51fd\u6578\uff0c\u9019\u7a2e\u65b9\u6cd5\u662f\u91dd\u5c0d\u71b1\u5716\u56de\u6b78\u4e2d\u7684\u640d\u5931\u51fd\u6578\u9032\u884c\u5275\u65b0\uff0c\u7279\u5225\u9069\u7528\u65bc\u4eba\u81c9\u5c0d\u9f4a\u554f\u984c\u3002\u5176\u6838\u5fc3\u601d\u60f3\u662f\u8b93\u640d\u5931\u51fd\u6578\u80fd\u5920\u6839\u64da\u4e0d\u540c\u985e\u578b\u7684\u771f\u5be6\u71b1\u5716\u50cf\u7d20\u8abf\u6574\u5176\u5f62\u72c0\uff0c\u5c0d\u524d\u666f\u50cf\u7d20\uff08\u5373\u4eba\u81c9\u7279\u5fb5\u9ede\u9644\u8fd1\u7684\u50cf\u7d20\uff09\u65bd\u52a0\u66f4\u591a\u7684\u61f2\u7f70\uff0c\u800c\u5c0d\u80cc\u666f\u50cf\u7d20\u65bd\u52a0\u8f03\u5c11\u7684\u61f2\u7f70\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u9019\u88e1\uff0c\u6211\u5011\u5c07\u6587\u4ef6\u89d2\u9ede\u9810\u6e2c\u7684\u554f\u984c\u8996\u70ba\u4eba\u81c9\u95dc\u9375\u9ede\u6aa2\u6e2c\u554f\u984c\uff0c\u4e26\u4f7f\u7528\u5c08\u9580\u7528\u65bc\u4eba\u81c9\u95dc\u9375\u9ede\u6aa2\u6e2c\u7684\u640d\u5931\u51fd\u6578\u3002\u6211\u5011\u8a8d\u70ba\u9019\u7a2e\u65b9\u6cd5\u80fd\u5920\u6709\u6548\u5730\u89e3\u6c7a\u6587\u4ef6\u89d2\u9ede\u6aa2\u6e2c\u4e2d\u7684\u554f\u984c\uff0c\u4e26\u4e14\u80fd\u5920\u5728\u4e0d\u540c\u7684\u5834\u666f\u4e2d\u53d6\u5f97\u826f\u597d\u7684\u6548\u679c\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["Reference: ",(0,i.jsx)(n.a,{href:"https://arxiv.org/abs/1904.07399",children:"Adaptive Wing Loss for Robust Face Alignment via Heatmap Regression"})]})}),"\n",(0,i.jsx)(n.p,{children:"\u9664\u4e86\u89d2\u9ede\u7684\u640d\u5931\u4e4b\u5916\uff0c\u6211\u5011\u4e5f\u7528\u4e86\u591a\u500b\u8f14\u52a9\u7684\u640d\u5931\uff0c\u5305\u62ec\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Edge Loss:"})," \u9019\u662f\u4e00\u7a2e\u7528\u65bc\u908a\u754c\u6aa2\u6e2c\u7684\u640d\u5931\u51fd\u6578\uff0c\u4e5f\u662f\u63a1\u7528\u71b1\u5716\u56de\u6b78\u7684\u6a5f\u5236\uff0c\u4f7f\u7528 AWing Loss\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Classification Loss:"})," \u9019\u662f\u4e00\u7a2e\u7528\u65bc\u5206\u985e\u7684\u640d\u5931\u51fd\u6578\uff0c\u7528\u65bc\u9810\u6e2c\u5716\u50cf\u4e2d\u662f\u5426\u5b58\u5728\u6587\u4ef6\uff0c\u4f7f\u7528 BCE Loss\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u9ede\u56de\u6b78",children:"\u9ede\u56de\u6b78"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"point-arch",src:s(32229).A+"",width:"4574",height:"3254"})}),"\n",(0,i.jsx)(n.h3,{id:"backbone-1",children:"Backbone"}),"\n",(0,i.jsx)(n.p,{children:"\u9019\u88e1\u7684 Backbone \u8ddf\u71b1\u5716\u56de\u6b78\u6a21\u578b\u7684 Backbone \u662f\u76f8\u540c\u7684\uff0c\u6211\u5011\u4f7f\u7528\u4e86 LCNet \u4f86\u63d0\u53d6\u7279\u5fb5\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u81f3\u65bc\u70ba\u4ec0\u9ebc\u4e0d\u653e\u68c4 CNN \u67b6\u69cb\uff0c\u63a1\u7528\u5168 Transformer \u67b6\u69cb\uff1f\u539f\u56e0\u662f\u53c3\u6578\u91cf\u548c\u8a08\u7b97\u91cf\u7684\u9650\u5236\u3002\u7d93\u904e\u6211\u5011\u7684\u5be6\u9a57\uff0c\u7576\u53c3\u6578\u91cf\u904e\u4f4e\u6642\uff0cTransformer \u7121\u6cd5\u5c55\u73fe\u51fa\u5176\u512a\u52e2\uff0c\u56e0\u6b64\u6211\u5011\u9078\u64c7\u4e86 LCNet \u4f5c\u70ba Backbone\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"neck-cross-attention",children:"Neck: Cross-Attention"}),"\n",(0,i.jsx)(n.p,{children:"Neck \u90e8\u5206\u662f\u7528\u65bc\u589e\u5f37\u5f9e Backbone \u6d41\u51fa\u7684\u7279\u5fb5\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u9019\u500b\u6a21\u578b\u4e2d\uff0c\u6211\u5011\u4f7f\u7528\u4e86 Cross-Attention \u6a5f\u5236\uff0c\u9019\u662f\u4e00\u7a2e Transformer \u4e2d\u5e38\u7528\u7684\u6a5f\u5236\uff0c\u80fd\u5920\u6355\u6349\u4e0d\u540c\u7279\u5fb5\u4e4b\u9593\u7684\u95dc\u4fc2\uff0c\u4e26\u5c07\u9019\u4e9b\u95dc\u4fc2\u61c9\u7528\u65bc\u7279\u5fb5\u7684\u589e\u5f37\u3002\u6211\u5011\u9810\u671f Cross-Attention \u80fd\u5920\u5e6b\u52a9\u6a21\u578b\u7406\u89e3\u5716\u50cf\u4e2d\u4e0d\u540c\u9ede\u4e4b\u9593\u7684\u7a7a\u9593\u95dc\u4fc2\uff0c\u5f9e\u800c\u63d0\u9ad8\u9810\u6e2c\u7684\u6e96\u78ba\u6027\u3002\u9664\u4e86 Cross-Attention \u4e4b\u5916\uff0c\u6211\u5011\u9084\u4f7f\u7528\u4e86\u4f4d\u7f6e\u7de8\u78bc\uff08positional encodings\uff09\uff0c\u9019\u4e9b\u7de8\u78bc\u6709\u52a9\u65bc\u6a21\u578b\u7406\u89e3\u5716\u50cf\u4e2d\u9ede\u7684\u7a7a\u9593\u4f4d\u7f6e\uff0c\u5f9e\u800c\u63d0\u9ad8\u9810\u6e2c\u7684\u6e96\u78ba\u6027\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u6211\u5011\u8003\u616e\u9ede\u56de\u6b78\u7684\u7279\u6027\uff0c\u5c0d\u65bc\u7cbe\u78ba\u7684\u50cf\u7d20\u5b9a\u4f4d\uff0c\u975e\u5e38\u4f9d\u8cf4\u65bc\u4f4e\u7d1a\u7684\u7279\u5fb5\u3002\u56e0\u6b64\u6211\u5011\u5f9e\u6df1\u5c64\u7279\u5fb5\u958b\u59cb\uff0c\u4f9d\u5e8f\u5f80\u6dfa\u5c64\u7279\u5fb5\uff081/32 -> 1/16 -> 1/8 -> 1/4 -> 1/2\uff09\u9032\u884c\u67e5\u8a62\uff0c\u9019\u6a23\u7684\u8a2d\u8a08\u80fd\u5920\u8b93\u6a21\u578b\u5728\u4e0d\u540c\u5c3a\u5ea6\u7684\u7279\u5fb5\u4e2d\u627e\u5230\u6587\u4ef6\u7684\u4f4d\u7f6e\u3002\u6211\u5011\u8a8d\u70ba\u9019\u7a2e\u67e5\u8a62\u65b9\u5f0f\u80fd\u5920\u6709\u6548\u5730\u63d0\u9ad8\u6a21\u578b\u7684\u6e96\u78ba\u6027\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"head-point-regression",children:"Head: Point Regression"}),"\n",(0,i.jsx)(n.p,{children:"\u6211\u5011\u50c5\u4f7f\u7528\u4e00\u500b\u7c21\u55ae\u7684\u7dda\u6027\u5c64\u4f5c\u70ba Head\uff0c\u5c07\u7279\u5fb5\u8f49\u63db\u70ba\u9ede\u7684\u5750\u6a19\u3002\u6211\u5011\u5e0c\u671b\u6a21\u578b\u53ef\u4ee5\u66f4\u4f9d\u8cf4\u65bc Cross-Attention \u7684\u7279\u5fb5\u7684\u8868\u9054\u80fd\u529b\uff0c\u800c\u4e0d\u662f\u4f9d\u8cf4\u65bc\u8907\u96dc\u982d\u90e8\u67b6\u69cb\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"loss-smooth-l1-loss",children:"Loss: Smooth L1 Loss"}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u6211\u5011\u7684\u6a21\u578b\u4e2d\uff0c\u6211\u5011\u9078\u64c7\u4f7f\u7528 Smooth L1 Loss \u4f5c\u70ba\u640d\u5931\u51fd\u6578\uff0c\u9019\u662f\u4e00\u7a2e\u5728\u56de\u6b78\u4efb\u52d9\u4e2d\u5e38\u7528\u7684\u640d\u5931\u51fd\u6578\uff0c\u7279\u5225\u9069\u7528\u65bc\u8655\u7406\u5b58\u5728\u7570\u5e38\u503c\u7684\u60c5\u6cc1\u3002\u8207\u50b3\u7d71\u7684 L1 Loss \u76f8\u6bd4\uff0cSmooth L1 Loss \u5728\u9810\u6e2c\u503c\u8207\u771f\u5be6\u503c\u5dee\u7570\u8f03\u5927\u6642\u66f4\u52a0\u7a69\u5065\uff0c\u80fd\u5920\u6e1b\u5c11\u7570\u5e38\u503c\u5c0d\u6a21\u578b\u8a13\u7df4\u7684\u5f71\u97ff\u3002\u6b64\u5916\uff0c\u70ba\u4e86\u964d\u4f4e\u9ede\u56de\u6b78\u7684\u653e\u5927\u8aa4\u5dee\uff0c\u6211\u5011\u5c07\u9ede\u9810\u6e2c\u7684\u6b0a\u91cd\u63d0\u9ad8\u81f3 1000\uff0c\u7d93\u904e\u6211\u5011\u7684\u5be6\u9a57\uff0c\u9019\u6a23\u7684\u8a2d\u8a08\u80fd\u5920\u6709\u6548\u5730\u63d0\u9ad8\u6a21\u578b\u7684\u6e96\u78ba\u6027\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u9664\u4e86\u89d2\u9ede\u7684\u640d\u5931\u4e4b\u5916\uff0c\u6211\u5011\u4e5f\u7528\u4e86\u5176\u4ed6\u7684\u640d\u5931\uff0c\u5305\u62ec\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Classification Loss:"})," \u9019\u662f\u4e00\u7a2e\u7528\u65bc\u5206\u985e\u7684\u640d\u5931\u51fd\u6578\uff0c\u7528\u65bc\u9810\u6e2c\u5716\u50cf\u4e2d\u662f\u5426\u5b58\u5728\u6587\u4ef6\uff0c\u4f7f\u7528 BCE Loss\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u8acb\u6ce8\u610f\uff0c\u9019\u88e1\u7684\u5206\u985e\u640d\u5931\u4e26\u975e\u53ea\u662f\u8f14\u52a9\u640d\u5931\uff0c\u800c\u662f\u4e3b\u8981\u640d\u5931\u4e4b\u4e00\uff0c\u56e0\u70ba\u89d2\u9ede\u9810\u6e2c\u672c\u8eab\u7684\u9650\u5236\uff0c\u7576\u9047\u5230\u6c92\u6709\u76ee\u6a19\u7269\u7684\u60c5\u6cc1\u6642\uff0c\u4ecd\u6703\u9810\u6e2c\u51fa\u89d2\u9ede\uff0c\u56e0\u6b64\u5728\u90e8\u7f72\u968e\u6bb5\uff0c\u6211\u5011\u9700\u8981\u5206\u985e\u982d\u4f86\u544a\u8a34\u6211\u5011\u662f\u5426\u6709\u76ee\u6a19\u7269\u3002"})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},31863:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/hmap_model_arch-5a3b42fd4d54769ec6f331952327e323.jpg"},32229:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/point_model_arch-cb2afeedf5c66ea527d29726f64e2f03.jpg"},28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>a});var i=s(96540);const r={},o=i.createContext(r);function t(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);